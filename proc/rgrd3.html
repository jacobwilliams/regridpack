<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Edition of REGRIDPACK">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>rgrd3 &ndash; regridpack</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">regridpack </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/regridpack_module.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/regridpack_module.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>rgrd3
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 7.1% of total for procedures.">175 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/regridpack_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/regridpack_module.f90.html'>regridpack_module.f90</a></li>
    
     <li><a href='../module/regridpack_module.html'>regridpack_module</a></li>
    
  
     <li class="active">rgrd3</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/rgrd3.html#src">rgrd3</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
private subroutine rgrd3(nx, ny, nz, x, y, z, p, mx, my, mz, xx, yy, zz, q, intpol, w, lw, iw, liw, ier)
    
    
   
</h2>
    
  


    
    <p>subroutine rgrd3 interpolates the values p(i,j,k) on the orthogonal
  grid (x(i),y(j),z(k)) for i=1,...,nx; j=1,...,ny; k=1,...,nz
  onto q(ii,jj,kk) on the orthogonal grid (xx(ii),yy(jj),zz(kk)) for
  ii=1,...,mx; jj=1,...,my; kk=1,...,mz.</p>
<h3>method</h3>
<p>linear or cubic interpolation is used (independently) in
  each direction (see argument intpol).</p>
<h3>requirements</h3>
<p>each of the x,y,z grids must be strictly montonically increasing
  and each of the xx,yy,zz grids must be montonically increasing
  (see ier = 4).  in addition the (X,Y,Z) region</p>
<div class="codehilite"><pre><span></span><code>[xx(1),xx(mx)] X [yy(1),yy(my)] X [zz(1),zz(mz)]
</code></pre></div>

<p>must lie within the (X,Y,Z) region</p>
<div class="codehilite"><pre><span></span><code>[x(1),x(nx)] X [y(1),y(ny)] X [z(1),z(nz)].
</code></pre></div>

<p>extrapolation is not allowed (see ier=3).  if these (X,Y,Z)
  regions are identical and the orthogonal grids are UNIFORM
  in each direction then subroutine rgrd3u
  should be used instead of rgrd3.</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nx~17"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nx</strong></td><td><p>the integer dimension of the grid vector x and the first dimension of p.
nx &gt; 1 if intpol(1) = 1 or nx &gt; 3 if intpol(1) = 3 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ny~7"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ny</strong></td><td><p>the integer dimension of the grid vector y and the second dimension of p.
ny &gt; 1 if intpol(2) = 1 or ny &gt; 3 if intpol(2) = 3 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nz"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nz</strong></td><td><p>the integer dimension of the grid vector z and the third dimension of p.
nz &gt; 1 if intpol(3) = 1 or nz &gt; 3 if intpol(3) = 3 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x~9"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong>(nx)</td><td><p>a real(wp) nx vector of strictly increasing values which defines the x
portion of the orthogonal grid on which p is given</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y~5"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong>(ny)</td><td><p>a real(wp) ny vector of strictly increasing values which defines the y
portion of the orthogonal grid on which p is given</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-z~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong>(nz)</td><td><p>a real(wp) nz vector of strictly increasing values which defines the z
portion of the orthogonal grid on which p is given</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~17"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>p</strong>(nx,ny,nz)</td><td><p>a real(wp) nx by ny by nz array of values given on the (x,y,z) grid</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mx~17"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mx</strong></td><td><p>the integer dimension of the grid vector xx and the first dimension of q.
mx &gt; 0 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-my~7"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>my</strong></td><td><p>the integer dimension of the grid vector yy and the second dimension of q.
my &gt; 0 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mz"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mz</strong></td><td><p>the integer dimension of the grid vector zz and the third dimension of q.
mz &gt; 0 is required.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xx~9"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xx</strong>(mx)</td><td><p>a real(wp) mx vector of increasing values which defines the x portion of the
orthogonal grid on which q is defined.  xx(1) &lt; x(1) or xx(mx) &gt; x(nx)
is not allowed (see ier = 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-yy~5"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>yy</strong>(my)</td><td><p>a real(wp) my vector of increasing values which defines the y portion of the
orthogonal grid on which q is defined.  yy(1) &lt; y(1) or yy(my) &gt; y(ny)
is not allowed (see ier = 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-zz~3"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>zz</strong>(mz)</td><td><p>a real(wp) mz vector of increasing values which defines the z portion of the
orthogonal grid on which q is defined.  zz(1) &lt; z(1) or zz(mz) &gt; z(nz)
is not allowed (see ier = 3)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q~17"></span>real(kind=wp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q</strong>(mx,my,mz)</td><td><p>a real(wp) mx by my by mz array of values
on the (xx,yy,zz) grid which are
interpolated from p on the (x,y,z) grid</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-intpol~13"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>intpol</strong>(3)</td><td><p>an integer vector of dimension 3 which sets linear or cubic
interpolation in each of the x,y,z directions as follows:</p>
<ul>
<li>intpol(1) = 1 sets linear interpolation in the x direction</li>
<li>intpol(1) = 3 sets cubic interpolation in the x direction.</li>
<li>intpol(2) = 1 sets linear interpolation in the y direction</li>
<li>intpol(2) = 3 sets cubic interpolation in the y direction.</li>
<li>intpol(3) = 1 sets linear interpolation in the z direction</li>
<li>intpol(3) = 3 sets cubic interpolation in the z direction.</li>
</ul>
<p>values other than 1 or 3 in intpol are not allowed (ier = 5).</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-w~5"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>w</strong>(lw)</td><td><p>a real(wp) work space of length at least
lw which must be provided in the
routine calling rgrd3</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lw~5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lw</strong></td><td><p>the integer length of the real(wp) work space w.  let</p>
<ul>
<li>lwx = mx              if intpol(1) = 1</li>
<li>lwx = 4*mx            if intpol(1) = 3</li>
<li>lwy = my+2*mx         if intpol(2) = 1</li>
<li>lwy = 4*(mx+my)       if intpol(2) = 3</li>
<li>lwz = 2<em>mx</em>my+mz      if intpol(3) = 1</li>
<li>lwz = 4<em>(mx</em>my+mz)    if intpol(3) = 3</li>
</ul>
<p>then lw must be greater than or equal to lwx+lwy+lwz</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iw~5"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iw</strong>(liw)</td><td><p>an integer work space of length at least
liw which must be provided in the
routine calling rgrd3</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-liw~5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>liw</strong></td><td><p>the integer length of the integer work space iw.  liw must be at least mx+my+mz</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ier~9"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ier</strong></td><td><p>an integer error flag set as follows:</p>
<ul>
<li>ier = 0 if no errors in input arguments are detected</li>
<li>ier = 1 if  min(mx,my,mz) &lt; 1</li>
<li>ier = 2 if nx &lt; 2 when intpol(1)=1 or nx &lt; 4 when intpol(1)=3 (or)
                    ny &lt; 2 when intpol(2)=1 or ny &lt; 4 when intpol(2)=3 (or)
                    nz &lt; 2 when intpol(3)=1 or nz &lt; 4 when intpol(3)=3.</li>
<li>ier = 3 if xx(1) &lt; x(1) or x(nx) &lt; xx(mx) (or)
                    yy(1) &lt; y(1) or y(ny) &lt; yy(my) (or)
                    zz(1) &lt; z(1) or z(nz) &lt; zz(mz)
   to avoid this flag when end points are intended to be the
   same but may differ slightly due to roundoff error, they
   should be set exactly in the calling routine (e.g., if both
   grids have the same y boundaries then yy(1)=y(1) and yy(my)=y(ny)
   should be set before calling rgrd3)</li>
<li>
<p>ier = 4 if one of the grids x,y,z is not strictly monotonically
  increasing or if one of the grids xx,yy,zz is not
  montonically increasing.  more precisely if:</p>
</li>
<li>
<p>x(i+1) &lt;= x(i) for some i such that 1 &lt;= i &lt; nx (or)</p>
</li>
<li>y(j+1) &lt;= y(j) for some j such that 1 &lt;= j &lt; ny (or)</li>
<li>z(k+1) &lt;= z(k) for some k such that 1 &lt;= k &lt; nz (or)</li>
<li>xx(ii+1) &lt; xx(ii) for some ii such that 1 &lt;= ii &lt; mx (or)</li>
<li>yy(jj+1) &lt; yy(jj) for some jj such that 1 &lt;= jj &lt; my (or)</li>
<li>zz(kk+1) &lt; zz(k)  for some kk such that 1 &lt;= kk &lt; mz</li>
<li>ier = 5 if lw or liw is too small (insufficient work space)</li>
<li>ier = 6 if any of intpol(1),intpol(2),intpol(3) is not equal to 1 or 3</li>
</ul></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~rgrd3~~CallsGraph Pages: 1 -->
<svg id="procrgrd3CallsGraph" width="333pt" height="158pt"
 viewBox="0.00 0.00 333.00 158.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~rgrd3~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 154)">
<title>proc~~rgrd3~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-154 329,-154 329,4 -4,4"/>
<!-- proc~rgrd3 -->
<g id="proc~~rgrd3~~CallsGraph_node1" class="node">
<title>proc~rgrd3</title>
<polygon fill="none" stroke="black" points="54,-87 0,-87 0,-63 54,-63 54,-87"/>
<text text-anchor="middle" x="27" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50">rgrd3</text>
</g>
<!-- proc~cubnmx -->
<g id="proc~~rgrd3~~CallsGraph_node2" class="node">
<title>proc~cubnmx</title>
<g id="a_proc~~rgrd3~~CallsGraph_node2"><a xlink:href=".././proc/cubnmx.html" xlink:title="cubnmx">
<polygon fill="#d9534f" stroke="#d9534f" points="145,-150 90,-150 90,-126 145,-126 145,-150"/>
<text text-anchor="middle" x="117.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cubnmx</text>
</a>
</g>
</g>
<!-- proc~rgrd3&#45;&gt;proc~cubnmx -->
<g id="proc~~rgrd3~~CallsGraph_edge1" class="edge">
<title>proc~rgrd3&#45;&gt;proc~cubnmx</title>
<path fill="none" stroke="#000000" d="M45.06,-87.15C58.16,-96.47 76.45,-109.49 91.25,-120.02"/>
<polygon fill="#000000" stroke="#000000" points="89.31,-122.94 99.49,-125.89 93.37,-117.24 89.31,-122.94"/>
</g>
<!-- proc~cubt3 -->
<g id="proc~~rgrd3~~CallsGraph_node3" class="node">
<title>proc~cubt3</title>
<g id="a_proc~~rgrd3~~CallsGraph_node3"><a xlink:href=".././proc/cubt3.html" xlink:title="cubt3">
<polygon fill="#d9534f" stroke="#d9534f" points="144.5,-108 90.5,-108 90.5,-84 144.5,-84 144.5,-108"/>
<text text-anchor="middle" x="117.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cubt3</text>
</a>
</g>
</g>
<!-- proc~rgrd3&#45;&gt;proc~cubt3 -->
<g id="proc~~rgrd3~~CallsGraph_edge2" class="edge">
<title>proc~rgrd3&#45;&gt;proc~cubt3</title>
<path fill="none" stroke="#000000" d="M54.07,-81.19C62.37,-83.16 71.7,-85.37 80.57,-87.47"/>
<polygon fill="#000000" stroke="#000000" points="79.77,-90.88 90.31,-89.78 81.38,-84.07 79.77,-90.88"/>
</g>
<!-- proc~linmx -->
<g id="proc~~rgrd3~~CallsGraph_node4" class="node">
<title>proc~linmx</title>
<g id="a_proc~~rgrd3~~CallsGraph_node4"><a xlink:href=".././proc/linmx.html" xlink:title="linmx">
<polygon fill="#d9534f" stroke="#d9534f" points="144.5,-24 90.5,-24 90.5,0 144.5,0 144.5,-24"/>
<text text-anchor="middle" x="117.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">linmx</text>
</a>
</g>
</g>
<!-- proc~rgrd3&#45;&gt;proc~linmx -->
<g id="proc~~rgrd3~~CallsGraph_edge3" class="edge">
<title>proc~rgrd3&#45;&gt;proc~linmx</title>
<path fill="none" stroke="#000000" d="M45.06,-62.85C58.16,-53.53 76.45,-40.51 91.25,-29.98"/>
<polygon fill="#000000" stroke="#000000" points="93.37,-32.76 99.49,-24.11 89.31,-27.06 93.37,-32.76"/>
</g>
<!-- proc~lint3 -->
<g id="proc~~rgrd3~~CallsGraph_node5" class="node">
<title>proc~lint3</title>
<g id="a_proc~~rgrd3~~CallsGraph_node5"><a xlink:href=".././proc/lint3.html" xlink:title="lint3">
<polygon fill="#d9534f" stroke="#d9534f" points="144.5,-66 90.5,-66 90.5,-42 144.5,-42 144.5,-66"/>
<text text-anchor="middle" x="117.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lint3</text>
</a>
</g>
</g>
<!-- proc~rgrd3&#45;&gt;proc~lint3 -->
<g id="proc~~rgrd3~~CallsGraph_edge4" class="edge">
<title>proc~rgrd3&#45;&gt;proc~lint3</title>
<path fill="none" stroke="#000000" d="M54.07,-68.81C62.37,-66.84 71.7,-64.63 80.57,-62.53"/>
<polygon fill="#000000" stroke="#000000" points="81.38,-65.93 90.31,-60.22 79.77,-59.12 81.38,-65.93"/>
</g>
<!-- proc~cubt2 -->
<g id="proc~~rgrd3~~CallsGraph_node6" class="node">
<title>proc~cubt2</title>
<g id="a_proc~~rgrd3~~CallsGraph_node6"><a xlink:href=".././proc/cubt2.html" xlink:title="cubt2">
<polygon fill="#d9534f" stroke="#d9534f" points="235,-108 181,-108 181,-84 235,-84 235,-108"/>
<text text-anchor="middle" x="208" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cubt2</text>
</a>
</g>
</g>
<!-- proc~cubt3&#45;&gt;proc~cubt2 -->
<g id="proc~~rgrd3~~CallsGraph_edge5" class="edge">
<title>proc~cubt3&#45;&gt;proc~cubt2</title>
<path fill="none" stroke="#000000" d="M144.57,-96C152.78,-96 162,-96 170.78,-96"/>
<polygon fill="#000000" stroke="#000000" points="170.81,-99.5 180.81,-96 170.81,-92.5 170.81,-99.5"/>
</g>
<!-- proc~lint2 -->
<g id="proc~~rgrd3~~CallsGraph_node7" class="node">
<title>proc~lint2</title>
<g id="a_proc~~rgrd3~~CallsGraph_node7"><a xlink:href=".././proc/lint2.html" xlink:title="lint2">
<polygon fill="#d9534f" stroke="#d9534f" points="235,-66 181,-66 181,-42 235,-42 235,-66"/>
<text text-anchor="middle" x="208" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lint2</text>
</a>
</g>
</g>
<!-- proc~cubt3&#45;&gt;proc~lint2 -->
<g id="proc~~rgrd3~~CallsGraph_edge6" class="edge">
<title>proc~cubt3&#45;&gt;proc~lint2</title>
<path fill="none" stroke="#000000" d="M144.1,-83.85C152.9,-79.67 162.92,-74.92 172.32,-70.46"/>
<polygon fill="#000000" stroke="#000000" points="173.93,-73.57 181.46,-66.12 170.92,-67.25 173.93,-73.57"/>
</g>
<!-- proc~lint3&#45;&gt;proc~cubt2 -->
<g id="proc~~rgrd3~~CallsGraph_edge7" class="edge">
<title>proc~lint3&#45;&gt;proc~cubt2</title>
<path fill="none" stroke="#000000" d="M144.1,-66.15C152.9,-70.33 162.92,-75.08 172.32,-79.54"/>
<polygon fill="#000000" stroke="#000000" points="170.92,-82.75 181.46,-83.88 173.93,-76.43 170.92,-82.75"/>
</g>
<!-- proc~lint3&#45;&gt;proc~lint2 -->
<g id="proc~~rgrd3~~CallsGraph_edge8" class="edge">
<title>proc~lint3&#45;&gt;proc~lint2</title>
<path fill="none" stroke="#000000" d="M144.57,-54C152.78,-54 162,-54 170.78,-54"/>
<polygon fill="#000000" stroke="#000000" points="170.81,-57.5 180.81,-54 170.81,-50.5 170.81,-57.5"/>
</g>
<!-- proc~lint1 -->
<g id="proc~~rgrd3~~CallsGraph_node8" class="node">
<title>proc~lint1</title>
<g id="a_proc~~rgrd3~~CallsGraph_node8"><a xlink:href=".././proc/lint1.html" xlink:title="lint1">
<polygon fill="#d9534f" stroke="#d9534f" points="325,-108 271,-108 271,-84 325,-84 325,-108"/>
<text text-anchor="middle" x="298" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lint1</text>
</a>
</g>
</g>
<!-- proc~cubt2&#45;&gt;proc~lint1 -->
<g id="proc~~rgrd3~~CallsGraph_edge9" class="edge">
<title>proc~cubt2&#45;&gt;proc~lint1</title>
<path fill="none" stroke="#000000" d="M235.4,-96C243.39,-96 252.31,-96 260.82,-96"/>
<polygon fill="#000000" stroke="#000000" points="260.92,-99.5 270.92,-96 260.92,-92.5 260.92,-99.5"/>
</g>
<!-- proc~cubt1 -->
<g id="proc~~rgrd3~~CallsGraph_node9" class="node">
<title>proc~cubt1</title>
<g id="a_proc~~rgrd3~~CallsGraph_node9"><a xlink:href=".././proc/cubt1.html" xlink:title="cubt1">
<polygon fill="#d9534f" stroke="#d9534f" points="325,-66 271,-66 271,-42 325,-42 325,-66"/>
<text text-anchor="middle" x="298" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cubt1</text>
</a>
</g>
</g>
<!-- proc~cubt2&#45;&gt;proc~cubt1 -->
<g id="proc~~rgrd3~~CallsGraph_edge10" class="edge">
<title>proc~cubt2&#45;&gt;proc~cubt1</title>
<path fill="none" stroke="#000000" d="M234.45,-83.85C243.21,-79.67 253.17,-74.92 262.52,-70.46"/>
<polygon fill="#000000" stroke="#000000" points="264.09,-73.59 271.6,-66.12 261.07,-67.27 264.09,-73.59"/>
</g>
<!-- proc~lint2&#45;&gt;proc~lint1 -->
<g id="proc~~rgrd3~~CallsGraph_edge11" class="edge">
<title>proc~lint2&#45;&gt;proc~lint1</title>
<path fill="none" stroke="#000000" d="M234.45,-66.15C243.21,-70.33 253.17,-75.08 262.52,-79.54"/>
<polygon fill="#000000" stroke="#000000" points="261.07,-82.73 271.6,-83.88 264.09,-76.41 261.07,-82.73"/>
</g>
<!-- proc~lint2&#45;&gt;proc~cubt1 -->
<g id="proc~~rgrd3~~CallsGraph_edge12" class="edge">
<title>proc~lint2&#45;&gt;proc~cubt1</title>
<path fill="none" stroke="#000000" d="M235.4,-54C243.39,-54 252.31,-54 260.82,-54"/>
<polygon fill="#000000" stroke="#000000" points="260.92,-57.5 270.92,-54 260.92,-50.5 260.92,-57.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~rgrd3~~CalledByGraph Pages: 1 -->
<svg id="procrgrd3CalledByGraph" width="279pt" height="52pt"
 viewBox="0.00 0.00 279.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~rgrd3~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>proc~~rgrd3~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-48 275,-48 275,4 -4,4"/>
<!-- proc~rgrd3 -->
<g id="proc~~rgrd3~~CalledByGraph_node1" class="node">
<title>proc~rgrd3</title>
<polygon fill="none" stroke="black" points="271,-44 217,-44 217,-20 271,-20 271,-44"/>
<text text-anchor="middle" x="244" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50">rgrd3</text>
</g>
<!-- proc~rgrd3_wrapper -->
<g id="proc~~rgrd3~~CalledByGraph_node2" class="node">
<title>proc~rgrd3_wrapper</title>
<g id="a_proc~~rgrd3~~CalledByGraph_node2"><a xlink:href=".././proc/rgrd3_wrapper.html" xlink:title="rgrd3_wrapper">
<polygon fill="#d9534f" stroke="#d9534f" points="181,-24 90,-24 90,0 181,0 181,-24"/>
<text text-anchor="middle" x="135.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rgrd3_wrapper</text>
</a>
</g>
</g>
<!-- proc~rgrd3_wrapper&#45;&gt;proc~rgrd3 -->
<g id="proc~~rgrd3~~CalledByGraph_edge1" class="edge">
<title>proc~rgrd3_wrapper&#45;&gt;proc~rgrd3</title>
<path fill="none" stroke="#000000" d="M181.05,-20.37C189.63,-21.98 198.51,-23.65 206.78,-25.2"/>
<polygon fill="#000000" stroke="#000000" points="206.39,-28.69 216.87,-27.09 207.68,-21.81 206.39,-28.69"/>
</g>
<!-- interface~regrid -->
<g id="proc~~rgrd3~~CalledByGraph_node3" class="node">
<title>interface~regrid</title>
<g id="a_proc~~rgrd3~~CalledByGraph_node3"><a xlink:href=".././interface/regrid.html" xlink:title="regrid">
<polygon fill="#a7506f" stroke="#a7506f" points="54,-44 0,-44 0,-20 54,-20 54,-44"/>
<text text-anchor="middle" x="27" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">regrid</text>
</a>
</g>
</g>
<!-- interface~regrid&#45;&gt;proc~rgrd3 -->
<g id="proc~~rgrd3~~CalledByGraph_edge2" class="edge">
<title>interface~regrid&#45;&gt;proc~rgrd3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M54.24,-32.52C65.28,-32.71 78.27,-32.91 90,-33 130.44,-33.33 140.56,-33.33 181,-33 189.25,-32.93 198.12,-32.82 206.49,-32.69"/>
<polygon fill="#000000" stroke="#000000" points="206.81,-36.18 216.76,-32.52 206.7,-29.18 206.81,-36.18"/>
</g>
<!-- interface~regrid&#45;&gt;proc~rgrd3_wrapper -->
<g id="proc~~rgrd3~~CalledByGraph_edge3" class="edge">
<title>interface~regrid&#45;&gt;proc~rgrd3_wrapper</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M54.05,-27.11C61.84,-25.65 70.68,-23.98 79.59,-22.31"/>
<polygon fill="#000000" stroke="#000000" points="80.44,-25.71 89.62,-20.43 79.15,-18.83 80.44,-25.71"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/rgrd3.html#src">rgrd3</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">rgrd3</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">intpol</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">lw</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">liw</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">nx</span>   <span class="c">!! the integer dimension of the grid vector x and the first dimension of p.</span>
                                    <span class="c">!! nx &gt; 1 if intpol(1) = 1 or nx &gt; 3 if intpol(1) = 3 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ny</span>   <span class="c">!! the integer dimension of the grid vector y and the second dimension of p.</span>
                                    <span class="c">!! ny &gt; 1 if intpol(2) = 1 or ny &gt; 3 if intpol(2) = 3 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">nz</span>   <span class="c">!! the integer dimension of the grid vector z and the third dimension of p.</span>
                                    <span class="c">!! nz &gt; 1 if intpol(3) = 1 or nz &gt; 3 if intpol(3) = 3 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">mx</span>   <span class="c">!! the integer dimension of the grid vector xx and the first dimension of q.</span>
                                    <span class="c">!! mx &gt; 0 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">my</span>   <span class="c">!! the integer dimension of the grid vector yy and the second dimension of q.</span>
                                    <span class="c">!! my &gt; 0 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">mz</span>   <span class="c">!! the integer dimension of the grid vector zz and the third dimension of q.</span>
                                    <span class="c">!! mz &gt; 0 is required.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">lw</span>   <span class="c">!! the integer length of the real(wp) work space w.  let</span>
                                    <span class="c">!!</span>
                                    <span class="c">!! * lwx = mx              if intpol(1) = 1</span>
                                    <span class="c">!! * lwx = 4*mx            if intpol(1) = 3</span>
                                    <span class="c">!! * lwy = my+2*mx         if intpol(2) = 1</span>
                                    <span class="c">!! * lwy = 4*(mx+my)       if intpol(2) = 3</span>
                                    <span class="c">!! * lwz = 2*mx*my+mz      if intpol(3) = 1</span>
                                    <span class="c">!! * lwz = 4*(mx*my+mz)    if intpol(3) = 3</span>
                                    <span class="c">!!</span>
                                    <span class="c">!! then lw must be greater than or equal to lwx+lwy+lwz</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">liw</span>  <span class="c">!! the integer length of the integer work space iw.  liw must be at least mx+my+mz</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ier</span>  <span class="c">!! an integer error flag set as follows:</span>
                                    <span class="c">!!</span>
                                    <span class="c">!! * ier = 0 if no errors in input arguments are detected</span>
                                    <span class="c">!! * ier = 1 if  min(mx,my,mz) &lt; 1</span>
                                    <span class="c">!! * ier = 2 if nx &lt; 2 when intpol(1)=1 or nx &lt; 4 when intpol(1)=3 (or)</span>
                                    <span class="c">!!                     ny &lt; 2 when intpol(2)=1 or ny &lt; 4 when intpol(2)=3 (or)</span>
                                    <span class="c">!!                     nz &lt; 2 when intpol(3)=1 or nz &lt; 4 when intpol(3)=3.</span>
                                    <span class="c">!! * ier = 3 if xx(1) &lt; x(1) or x(nx) &lt; xx(mx) (or)</span>
                                    <span class="c">!!                     yy(1) &lt; y(1) or y(ny) &lt; yy(my) (or)</span>
                                    <span class="c">!!                     zz(1) &lt; z(1) or z(nz) &lt; zz(mz)</span>
                                    <span class="c">!!    to avoid this flag when end points are intended to be the</span>
                                    <span class="c">!!    same but may differ slightly due to roundoff error, they</span>
                                    <span class="c">!!    should be set exactly in the calling routine (e.g., if both</span>
                                    <span class="c">!!    grids have the same y boundaries then yy(1)=y(1) and yy(my)=y(ny)</span>
                                    <span class="c">!!    should be set before calling rgrd3)</span>
                                    <span class="c">!! * ier = 4 if one of the grids x,y,z is not strictly monotonically</span>
                                    <span class="c">!!   increasing or if one of the grids xx,yy,zz is not</span>
                                    <span class="c">!!   montonically increasing.  more precisely if:</span>
                                    <span class="c">!!</span>
                                    <span class="c">!!    * x(i+1) &lt;= x(i) for some i such that 1 &lt;= i &lt; nx (or)</span>
                                    <span class="c">!!    * y(j+1) &lt;= y(j) for some j such that 1 &lt;= j &lt; ny (or)</span>
                                    <span class="c">!!    * z(k+1) &lt;= z(k) for some k such that 1 &lt;= k &lt; nz (or)</span>
                                    <span class="c">!!    * xx(ii+1) &lt; xx(ii) for some ii such that 1 &lt;= ii &lt; mx (or)</span>
                                    <span class="c">!!    * yy(jj+1) &lt; yy(jj) for some jj such that 1 &lt;= jj &lt; my (or)</span>
                                    <span class="c">!!    * zz(kk+1) &lt; zz(k)  for some kk such that 1 &lt;= kk &lt; mz</span>
                                    <span class="c">!! * ier = 5 if lw or liw is too small (insufficient work space)</span>
                                    <span class="c">!! * ier = 6 if any of intpol(1),intpol(2),intpol(3) is not equal to 1 or 3</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>  <span class="c">!! a real(wp) nx vector of strictly increasing values which defines the x</span>
                                      <span class="c">!! portion of the orthogonal grid on which p is given</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">y</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span>  <span class="c">!! a real(wp) ny vector of strictly increasing values which defines the y</span>
                                      <span class="c">!! portion of the orthogonal grid on which p is given</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">z</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span>  <span class="c">!! a real(wp) nz vector of strictly increasing values which defines the z</span>
                                      <span class="c">!! portion of the orthogonal grid on which p is given</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">p</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nz</span><span class="p">)</span>  <span class="c">!! a real(wp) nx by ny by nz array of values given on the (x,y,z) grid</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">xx</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span>   <span class="c">!! a real(wp) mx vector of increasing values which defines the x portion of the</span>
                                        <span class="c">!! orthogonal grid on which q is defined.  xx(1) &lt; x(1) or xx(mx) &gt; x(nx)</span>
                                        <span class="c">!! is not allowed (see ier = 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">yy</span><span class="p">(</span><span class="n">my</span><span class="p">)</span>   <span class="c">!! a real(wp) my vector of increasing values which defines the y portion of the</span>
                                        <span class="c">!! orthogonal grid on which q is defined.  yy(1) &lt; y(1) or yy(my) &gt; y(ny)</span>
                                        <span class="c">!! is not allowed (see ier = 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">zz</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>   <span class="c">!! a real(wp) mz vector of increasing values which defines the z portion of the</span>
                                        <span class="c">!! orthogonal grid on which q is defined.  zz(1) &lt; z(1) or zz(mz) &gt; z(nz)</span>
                                        <span class="c">!! is not allowed (see ier = 3)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">q</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mz</span><span class="p">)</span>  <span class="c">!! a real(wp) mx by my by mz array of values</span>
                                            <span class="c">!! on the (xx,yy,zz) grid which are</span>
                                            <span class="c">!! interpolated from p on the (x,y,z) grid</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">w</span><span class="p">(</span><span class="n">lw</span><span class="p">)</span>    <span class="c">!! a real(wp) work space of length at least</span>
                                        <span class="c">!! lw which must be provided in the</span>
                                        <span class="c">!! routine calling rgrd3</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>    <span class="c">!! an integer vector of dimension 3 which sets linear or cubic</span>
                                            <span class="c">!! interpolation in each of the x,y,z directions as follows:</span>
                                            <span class="c">!!</span>
                                            <span class="c">!! * intpol(1) = 1 sets linear interpolation in the x direction</span>
                                            <span class="c">!! * intpol(1) = 3 sets cubic interpolation in the x direction.</span>
                                            <span class="c">!! * intpol(2) = 1 sets linear interpolation in the y direction</span>
                                            <span class="c">!! * intpol(2) = 3 sets cubic interpolation in the y direction.</span>
                                            <span class="c">!! * intpol(3) = 1 sets linear interpolation in the z direction</span>
                                            <span class="c">!! * intpol(3) = 3 sets cubic interpolation in the z direction.</span>
                                            <span class="c">!!</span>
                                            <span class="c">!! values other than 1 or 3 in intpol are not allowed (ier = 5).</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iw</span><span class="p">(</span><span class="n">liw</span><span class="p">)</span>  <span class="c">!! an integer work space of length at least</span>
                                        <span class="c">!! liw which must be provided in the</span>
                                        <span class="c">!! routine calling rgrd3</span>

    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">ii</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kk</span>
    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">i2</span><span class="p">,</span><span class="n">i3</span><span class="p">,</span><span class="n">i4</span><span class="p">,</span><span class="n">i5</span>
    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">j2</span><span class="p">,</span><span class="n">j3</span><span class="p">,</span><span class="n">j4</span><span class="p">,</span><span class="n">j5</span><span class="p">,</span><span class="n">j6</span><span class="p">,</span><span class="n">j7</span><span class="p">,</span><span class="n">j8</span><span class="p">,</span><span class="n">j9</span>
    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">k2</span><span class="p">,</span><span class="n">k3</span><span class="p">,</span><span class="n">k4</span><span class="p">,</span><span class="n">k5</span><span class="p">,</span><span class="n">k6</span><span class="p">,</span><span class="n">k7</span><span class="p">,</span><span class="n">k8</span><span class="p">,</span><span class="n">k9</span>
    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">lwx</span><span class="p">,</span><span class="n">lwy</span><span class="p">,</span><span class="n">lwz</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">kz</span><span class="p">,</span><span class="n">mxmy</span>

    <span class="c">! check input arguments</span>

    <span class="c">! check (xx,yy,zz) grid resolution</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mz</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span>

    <span class="c">! check intpol</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/=</span><span class="mi">3</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/=</span><span class="mi">3</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/=</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/=</span><span class="mi">3</span><span class="p">)</span> <span class="k">return</span>

    <span class="c">! check (x,y,z) grid resolution</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nx</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nx</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ny</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ny</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nz</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">nz</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">)</span> <span class="k">return</span>

    <span class="c">! check work space length input and set minimum</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">mxmy</span> <span class="o">=</span> <span class="n">mx</span><span class="o">*</span><span class="n">my</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">lwx</span> <span class="o">=</span> <span class="n">mx</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">lwx</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">mx</span>
    <span class="k">end if</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">lwy</span> <span class="o">=</span> <span class="p">(</span><span class="n">my</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">mx</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">lwy</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">my</span><span class="o">+</span><span class="n">mx</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">lwz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mxmy</span><span class="o">+</span><span class="n">mz</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">        </span><span class="n">lwz</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">mxmy</span><span class="o">+</span><span class="n">mz</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">lw</span> <span class="o">&lt;</span> <span class="n">lwx</span><span class="o">+</span><span class="n">lwy</span><span class="o">+</span><span class="n">lwz</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">liw</span> <span class="o">&lt;</span> <span class="n">mx</span><span class="o">+</span><span class="n">my</span><span class="o">+</span><span class="n">mz</span><span class="p">)</span> <span class="k">return</span>

    <span class="c">! check (xx,yy,zz) grid contained in (x,y,z) grid</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">xx</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span><span class="o">&gt;</span><span class="n">x</span><span class="p">(</span><span class="n">nx</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">yy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">yy</span><span class="p">(</span><span class="n">my</span><span class="p">)</span><span class="o">&gt;</span><span class="n">y</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">zz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">zz</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span><span class="o">&gt;</span><span class="n">z</span><span class="p">(</span><span class="n">nz</span><span class="p">))</span> <span class="k">return</span>

    <span class="c">! check montonicity of grids</span>
    <span class="n">ier</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">nx</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>
<span class="k">    do </span><span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ny</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>
<span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">nz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">z</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">z</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>
<span class="k">    do </span><span class="n">ii</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">mx</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xx</span><span class="p">(</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">xx</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>
<span class="k">    do </span><span class="n">jj</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">my</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">yy</span><span class="p">(</span><span class="n">jj</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">yy</span><span class="p">(</span><span class="n">jj</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>
<span class="k">    do </span><span class="n">kk</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">mz</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">zz</span><span class="p">(</span><span class="n">kk</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">zz</span><span class="p">(</span><span class="n">kk</span><span class="p">))</span> <span class="k">return</span>
<span class="k">    end do</span>

    <span class="c">! arguments o.k.</span>

    <span class="n">ier</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">jy</span> <span class="o">=</span> <span class="n">mx</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">kz</span> <span class="o">=</span> <span class="n">mx</span><span class="o">+</span><span class="n">my</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>

        <span class="c">! linearly interpolate in nz, set work space pointers and scales</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">k2</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">k3</span><span class="o">+</span><span class="n">mz</span>
        <span class="n">k5</span> <span class="o">=</span> <span class="n">k4</span>
        <span class="n">k6</span> <span class="o">=</span> <span class="n">k5</span>
        <span class="n">k7</span> <span class="o">=</span> <span class="n">k6</span>
        <span class="n">k8</span> <span class="o">=</span> <span class="n">k7</span><span class="o">+</span><span class="n">mxmy</span>
        <span class="n">k9</span> <span class="o">=</span> <span class="n">k8</span><span class="o">+</span><span class="n">mxmy</span>
        <span class="k">call </span><span class="n">linmx</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">kz</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k3</span><span class="p">))</span>
        <span class="n">j2</span> <span class="o">=</span> <span class="n">k9</span>

        <span class="c">! set indices and scales which depend on y interpolation</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
            <span class="c">! linear in y</span>
            <span class="n">j3</span> <span class="o">=</span> <span class="n">j2</span>
            <span class="n">j4</span> <span class="o">=</span> <span class="n">j3</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j5</span> <span class="o">=</span> <span class="n">j4</span>
            <span class="n">j6</span> <span class="o">=</span> <span class="n">j5</span>
            <span class="n">j7</span> <span class="o">=</span> <span class="n">j6</span>
            <span class="n">j8</span> <span class="o">=</span> <span class="n">j7</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j9</span> <span class="o">=</span> <span class="n">j8</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">linmx</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">))</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">j9</span>
        <span class="k">else</span>
            <span class="c">! cubic in y</span>
            <span class="n">j3</span> <span class="o">=</span> <span class="n">j2</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j4</span> <span class="o">=</span> <span class="n">j3</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j5</span> <span class="o">=</span> <span class="n">j4</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j6</span> <span class="o">=</span> <span class="n">j5</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j7</span> <span class="o">=</span> <span class="n">j6</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j8</span> <span class="o">=</span> <span class="n">j7</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j9</span> <span class="o">=</span> <span class="n">j8</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">cubnmx</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j5</span><span class="p">))</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">j9</span><span class="o">+</span><span class="n">mx</span>
        <span class="k">end if</span>

        <span class="c">! set indices and scales which depend on x interpolation</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
            <span class="c">! linear in x</span>
            <span class="n">i3</span> <span class="o">=</span> <span class="n">i2</span>
            <span class="n">i4</span> <span class="o">=</span> <span class="n">i3</span>
            <span class="n">i5</span> <span class="o">=</span> <span class="n">i4</span>
            <span class="k">call </span><span class="n">linmx</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">))</span>
        <span class="k">else</span>
            <span class="c">! cubic in x</span>
            <span class="n">i3</span> <span class="o">=</span> <span class="n">i2</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">i4</span> <span class="o">=</span> <span class="n">i3</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">i5</span> <span class="o">=</span> <span class="n">i4</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">cubnmx</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i5</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">lint3</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mxmy</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">intpol</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">kz</span><span class="p">),&amp;</span>
                    <span class="n">w</span><span class="p">(</span><span class="n">k3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k7</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k8</span><span class="p">),</span><span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j5</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j6</span><span class="p">),&amp;</span>
                    <span class="n">w</span><span class="p">(</span><span class="n">j7</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j8</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j9</span><span class="p">),</span><span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i5</span><span class="p">))</span>

    <span class="k">else</span>

        <span class="c">! cubically interpolate in z</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">k2</span><span class="o">+</span><span class="n">mz</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">k3</span><span class="o">+</span><span class="n">mz</span>
        <span class="n">k5</span> <span class="o">=</span> <span class="n">k4</span><span class="o">+</span><span class="n">mz</span>
        <span class="n">k6</span> <span class="o">=</span> <span class="n">k5</span><span class="o">+</span><span class="n">mz</span>
        <span class="n">k7</span> <span class="o">=</span> <span class="n">k6</span><span class="o">+</span><span class="n">mxmy</span>
        <span class="n">k8</span> <span class="o">=</span> <span class="n">k7</span><span class="o">+</span><span class="n">mxmy</span>
        <span class="n">k9</span> <span class="o">=</span> <span class="n">k8</span><span class="o">+</span><span class="n">mxmy</span>
        <span class="k">call </span><span class="n">cubnmx</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">zz</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">kz</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k5</span><span class="p">))</span>
        <span class="n">j2</span> <span class="o">=</span> <span class="n">k9</span><span class="o">+</span><span class="n">mxmy</span>

        <span class="c">! set indices which depend on y interpolation</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">j3</span> <span class="o">=</span> <span class="n">j2</span>
            <span class="n">j4</span> <span class="o">=</span> <span class="n">j3</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j5</span> <span class="o">=</span> <span class="n">j4</span>
            <span class="n">j6</span> <span class="o">=</span> <span class="n">j5</span>
            <span class="n">j7</span> <span class="o">=</span> <span class="n">j6</span>
            <span class="n">j8</span> <span class="o">=</span> <span class="n">j7</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j9</span> <span class="o">=</span> <span class="n">j8</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">linmx</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">))</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">j9</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">j3</span> <span class="o">=</span> <span class="n">j2</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j4</span> <span class="o">=</span> <span class="n">j3</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j5</span> <span class="o">=</span> <span class="n">j4</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j6</span> <span class="o">=</span> <span class="n">j5</span><span class="o">+</span><span class="n">my</span>
            <span class="n">j7</span> <span class="o">=</span> <span class="n">j6</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j8</span> <span class="o">=</span> <span class="n">j7</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">j9</span> <span class="o">=</span> <span class="n">j8</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">cubnmx</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j5</span><span class="p">))</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">j9</span><span class="o">+</span><span class="n">mx</span>
        <span class="k">end if</span>

        <span class="c">! set work space portion and indices which depend on x interpolation</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">intpol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">i3</span> <span class="o">=</span> <span class="n">i2</span>
            <span class="n">i4</span> <span class="o">=</span> <span class="n">i3</span>
            <span class="n">i5</span> <span class="o">=</span> <span class="n">i4</span>
            <span class="k">call </span><span class="n">linmx</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">))</span>
        <span class="k">else</span>
<span class="k">            </span><span class="n">i3</span> <span class="o">=</span> <span class="n">i2</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">i4</span> <span class="o">=</span> <span class="n">i3</span><span class="o">+</span><span class="n">mx</span>
            <span class="n">i5</span> <span class="o">=</span> <span class="n">i4</span><span class="o">+</span><span class="n">mx</span>
            <span class="k">call </span><span class="n">cubnmx</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i5</span><span class="p">))</span>
        <span class="k">end if</span>
<span class="k">        call </span><span class="n">cubt3</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">mxmy</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">intpol</span><span class="p">,&amp;</span>
                    <span class="n">iw</span><span class="p">(</span><span class="n">kz</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k5</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k6</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k7</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k8</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">k9</span><span class="p">),&amp;</span>
                    <span class="n">iw</span><span class="p">(</span><span class="n">jy</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j5</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j6</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j7</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j8</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">j9</span><span class="p">),&amp;</span>
                    <span class="n">iw</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i2</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i3</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i4</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">i5</span><span class="p">))</span>

    <span class="k">end if</span>

<span class="k">    end subroutine </span><span class="n">rgrd3</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>regridpack was developed by Jacob Williams<br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>